#!/bin/sh -eu

${DEBUG:-}

by="${1:-${USER}}"

cd steshaw.github.io
git checkout master
git pull origin master
git ls-files | xargs git rm

cp -r ../_site/* .

git add -A
if git diff-index --quiet HEAD; then
  echo No changes to commit
else
  git commit -m "Built by ${by} on $(date '+%d-%b-%Y %H:%M:%S %Z')"
  git push origin master
fi
